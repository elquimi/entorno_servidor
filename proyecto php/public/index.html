<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pok√©mon Calculator - Calculadora y Comparador de Pok√©mon</title>
    <base href="/temp/proyecto%20php/public/">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>üî¥ Pok√©mon Calculator</h1>
            <p>Busca, compara y analiza estad√≠sticas de Pok√©mon</p>
        </header>

        <!-- Navigation -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="search">Buscar Pok√©mon</button>
            <button class="nav-tab" data-tab="compare">Comparar Pok√©mon</button>
            <button class="nav-tab" data-tab="my-team">Mi Equipo</button>
            <button class="nav-tab" data-tab="damage-calc">Calculadora de Da√±o</button>
            <button class="nav-tab" data-tab="custom-stats">Estad√≠sticas Personalizadas</button>
        </nav>

        <!-- Tab 1: Search with list -->
        <section id="search" class="tab-content active">
            <div class="list-panel">
                <div class="list-header">
                    <input type="text" id="searchInput" placeholder="Buscar por nombre..." autocomplete="off">
                    <select id="sortMode" aria-label="Orden Pok√©dex">
                        <option value="asc">Pok√©dex ascendente</option>
                        <option value="desc">Pok√©dex descendente</option>
                    </select>
                </div>
                <ul id="pokemonList" class="pokemon-list"></ul>
            </div>
        </section>

        <!-- Tab 2: Compare -->
        <section id="compare" class="tab-content">
            <h2>Comparar Pok√©mon</h2>
            <div class="compare-container">
                <div class="compare-input">
                    <label>Pok√©mon 1:</label>
                    <div class="autocomplete-wrapper">
                        <input type="text" id="comparePokemon1" placeholder="Nombre del primer Pok√©mon..." autocomplete="off">
                        <ul id="suggestions1" class="autocomplete-list"></ul>
                    </div>
                </div>
                <div class="vs-label">VS</div>
                <div class="compare-input">
                    <label>Pok√©mon 2:</label>
                    <div class="autocomplete-wrapper">
                        <input type="text" id="comparePokemon2" placeholder="Nombre del segundo Pok√©mon..." autocomplete="off">
                        <ul id="suggestions2" class="autocomplete-list"></ul>
                    </div>
                </div>
            </div>
            <button class="btn btn-primary" onclick="comparePokemon()">Comparar</button>
            <div id="compareResults" class="results-container"></div>
        </section>

        <!-- Tab 3: Mi Equipo -->
        <section id="my-team" class="tab-content">
            <div class="team-header">
                <h2>Mi Equipo Pok√©mon</h2>
                <button class="btn btn-primary" onclick="openCreatePokemonModal()">+ Crear Pok√©mon</button>
            </div>
            <div id="teamList" class="team-grid">
                <!-- Los Pok√©mon del equipo se mostrar√°n aqu√≠ -->
            </div>
        </section>

        <!-- Tab 4: Calculadora de Da√±o -->
        <section id="damage-calc" class="tab-content">
            <h2>Calculadora de Da√±o</h2>
            <div class="damage-calc-container">
                <div class="damage-section">
                    <h3>Atacante</h3>
                    <button class="btn btn-secondary" onclick="openAttackerSelector()">Seleccionar Pok√©mon</button>
                    <div id="attackerInfo" class="pokemon-info-box"></div>
                </div>
                <div class="damage-section">
                    <h3>Defensor</h3>
                    <button class="btn btn-secondary" onclick="openDefenderSelector()">Seleccionar Pok√©mon</button>
                    <div id="defenderInfo" class="pokemon-info-box"></div>
                </div>
            </div>
            <div class="damage-section">
                <h3>Movimiento de Ataque</h3>
                <div class="move-selector">
                    <input type="text" id="moveNameDmg" placeholder="Nombre del movimiento..." >
                    <input type="number" id="movePowerDmg" placeholder="Poder del movimiento (0-150)" min="0" max="150" value="100">
                    <select id="moveTypeDmg">
                        <option value="">Seleccionar tipo...</option>
                        <option value="Normal">Normal</option>
                        <option value="Fuego">Fuego</option>
                        <option value="Agua">Agua</option>
                        <option value="El√©ctrico">El√©ctrico</option>
                        <option value="Planta">Planta</option>
                        <option value="Hielo">Hielo</option>
                        <option value="Lucha">Lucha</option>
                        <option value="Veneno">Veneno</option>
                        <option value="Tierra">Tierra</option>
                        <option value="Volador">Volador</option>
                        <option value="Ps√≠quico">Ps√≠quico</option>
                        <option value="Bicho">Bicho</option>
                        <option value="Roca">Roca</option>
                        <option value="Fantasma">Fantasma</option>
                        <option value="Drag√≥n">Drag√≥n</option>
                        <option value="Siniestro">Siniestro</option>
                        <option value="Acero">Acero</option>
                        <option value="Hada">Hada</option>
                    </select>
                </div>
            </div>
            <button class="btn btn-primary" onclick="calculateDamage()">Calcular Da√±o</button>
            <div id="damageResults" class="results-container"></div>
        </section>

        <!-- Tab 5: Custom Stats -->
        <section id="custom-stats" class="tab-content">
            <h2>Estad√≠sticas Personalizadas</h2>
            <div class="stats-form">
                <div class="stats-group">
                    <label>HP:</label>
                    <input type="number" id="hp" min="0" max="255" value="100">
                </div>
                <div class="stats-group">
                    <label>Ataque:</label>
                    <input type="number" id="attack" min="0" max="255" value="100">
                </div>
                <div class="stats-group">
                    <label>Defensa:</label>
                    <input type="number" id="defense" min="0" max="255" value="100">
                </div>
                <div class="stats-group">
                    <label>Ataque Esp.:</label>
                    <input type="number" id="spAtk" min="0" max="255" value="100">
                </div>
                <div class="stats-group">
                    <label>Defensa Esp.:</label>
                    <input type="number" id="spDef" min="0" max="255" value="100">
                </div>
                <div class="stats-group">
                    <label>Velocidad:</label>
                    <input type="number" id="speed" min="0" max="255" value="100">
                </div>
            </div>
            <button class="btn btn-primary" onclick="calculateCustomStats()">Calcular Estad√≠sticas</button>
            <div id="customStatsResults" class="results-container"></div>
        </section>
    </div>

    <script src="js/script.js"></script>
    <script src="js/team.js"></script>
    <script>
        // Inicializar carga de lista al abrir
        document.addEventListener('DOMContentLoaded', () => {
            loadPokemonList();
            const input = document.getElementById('searchInput');
            input.addEventListener('input', () => filterPokemonList(input.value));
        });
    </script>

    <!-- Modal para detalles del Pok√©mon -->
    <div id="pokemonModal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <button class="modal-close" onclick="closePokemonModal()">&times;</button>
            <div id="modalBody"></div>
        </div>
    </div>

    <!-- Modal para crear/editar Pok√©mon en equipo -->
    <div id="createPokemonModal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content large-modal">
            <button class="modal-close" onclick="closeCreatePokemonModal()">&times;</button>
            <h2>Agregar Pok√©mon al Equipo</h2>
            
            <div class="pokemon-type-selector">
                <button class="type-btn active" data-type="existing" onclick="switchPokemonType('existing', event)">Pok√©mon Existente</button>
                <button class="type-btn" data-type="custom" onclick="switchPokemonType('custom', event)">Pok√©mon Personalizado</button>
            </div>

            <!-- Formulario para Pok√©mon Existente -->
            <div id="existingPokemonForm" class="pokemon-form active">
                <h3>Seleccionar Pok√©mon Existente</h3>
                <div class="form-group">
                    <label>Pok√©mon:</label>
                    <div class="autocomplete-wrapper">
                        <input type="text" id="existingPokeName" placeholder="Buscar Pok√©mon..." autocomplete="off">
                        <ul id="existingSuggestions" class="autocomplete-list"></ul>
                    </div>
                </div>
                <div id="existingPokemonInfo" class="pokemon-info-section"></div>
                <div id="existingAbilitiesSection" class="form-group" style="display:none;">
                    <label>Habilidad:</label>
                    <div class="autocomplete-wrapper" style="margin-bottom: 10px;">
                        <input type="text" id="existingAbilitySearch" placeholder="Buscar habilidad..." autocomplete="off">
                    </div>
                    <select id="existingAbility"></select>
                </div>
                <div id="existingMovesSection" class="form-group" style="display:none;">
                    <label>Ataques (m√°ximo 4, usa el buscador):</label>
                    <div class="autocomplete-wrapper" style="margin-bottom: 15px;">
                        <input type="text" id="existingMoveSearch" placeholder="Buscar ataque..." autocomplete="off">
                        <ul id="existingMoveSuggestions" class="autocomplete-list"></ul>
                    </div>
                    <div class="moves-list" id="existingMovesList"></div>
                </div>
            </div>

            <!-- Formulario para Pok√©mon Personalizado -->
            <div id="customPokemonForm" class="pokemon-form" style="display:none;">
                <h3>Crear Pok√©mon Personalizado</h3>
                <div class="form-group">
                    <label>Pok√©mon base (para imagen):</label>
                    <div class="autocomplete-wrapper">
                        <input type="text" id="customBasePokeName" placeholder="Buscar Pok√©mon..." autocomplete="off">
                        <ul id="customBaseSuggestions" class="autocomplete-list"></ul>
                    </div>
                </div>
                <div class="form-group">
                    <label>Mote (obligatorio):</label>
                    <input type="text" id="customNickname" placeholder="Ej: Mi Drag√≥n Favorito" required>
                </div>
                <div class="form-group">
                    <label>Tipos:</label>
                    <div style="display: flex; gap: 10px;">
                        <div style="flex: 1;">
                            <label style="font-size: 0.9em; color: #666;">Tipo 1 (obligatorio):</label>
                            <select id="customType1" required>
                                <option value="">Seleccionar tipo...</option>
                                <option value="Normal">Normal</option>
                                <option value="Fuego">Fuego</option>
                                <option value="Agua">Agua</option>
                                <option value="El√©ctrico">El√©ctrico</option>
                                <option value="Planta">Planta</option>
                                <option value="Hielo">Hielo</option>
                                <option value="Lucha">Lucha</option>
                                <option value="Veneno">Veneno</option>
                                <option value="Tierra">Tierra</option>
                                <option value="Volador">Volador</option>
                                <option value="Ps√≠quico">Ps√≠quico</option>
                                <option value="Bicho">Bicho</option>
                                <option value="Roca">Roca</option>
                                <option value="Fantasma">Fantasma</option>
                                <option value="Drag√≥n">Drag√≥n</option>
                                <option value="Siniestro">Siniestro</option>
                                <option value="Acero">Acero</option>
                                <option value="Hada">Hada</option>
                            </select>
                        </div>
                        <div style="flex: 1;">
                            <label style="font-size: 0.9em; color: #666;">Tipo 2 (opcional):</label>
                            <select id="customType2">
                                <option value="">Ninguno</option>
                                <option value="Normal">Normal</option>
                                <option value="Fuego">Fuego</option>
                                <option value="Agua">Agua</option>
                                <option value="El√©ctrico">El√©ctrico</option>
                                <option value="Planta">Planta</option>
                                <option value="Hielo">Hielo</option>
                                <option value="Lucha">Lucha</option>
                                <option value="Veneno">Veneno</option>
                                <option value="Tierra">Tierra</option>
                                <option value="Volador">Volador</option>
                                <option value="Ps√≠quico">Ps√≠quico</option>
                                <option value="Bicho">Bicho</option>
                                <option value="Roca">Roca</option>
                                <option value="Fantasma">Fantasma</option>
                                <option value="Drag√≥n">Drag√≥n</option>
                                <option value="Siniestro">Siniestro</option>
                                <option value="Acero">Acero</option>
                                <option value="Hada">Hada</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <h4>Estad√≠sticas Base</h4>
                <div class="stats-grid">
                    <div class="form-group">
                        <label>HP:</label>
                        <input type="number" id="customHP" min="1" max="255" value="100">
                    </div>
                    <div class="form-group">
                        <label>Ataque:</label>
                        <input type="number" id="customAtk" min="1" max="255" value="100">
                    </div>
                    <div class="form-group">
                        <label>Defensa:</label>
                        <input type="number" id="customDef" min="1" max="255" value="100">
                    </div>
                    <div class="form-group">
                        <label>Ataque Esp.:</label>
                        <input type="number" id="customSpAtk" min="1" max="255" value="100">
                    </div>
                    <div class="form-group">
                        <label>Defensa Esp.:</label>
                        <input type="number" id="customSpDef" min="1" max="255" value="100">
                    </div>
                    <div class="form-group">
                        <label>Velocidad:</label>
                        <input type="number" id="customSpeed" min="1" max="255" value="100">
                    </div>
                </div>

                <div class="form-group">
                    <label>Habilidades del Pok√©mon base (obligatoria si no eliges otra):</label>
                    <select id="customAbilityPredefined" style="width: 100%;">
                        <option value="">Seleccionar habilidad...</option>
                    </select>
                    <div style="margin-top: 10px; display:flex; align-items:center; gap:10px;">
                        <button class="btn btn-secondary" onclick="openAbilitySelector()">Otras habilidades</button>
                        <span id="customAbilityOtherLabel" style="font-size:0.9em; color:#666; display:none;">Seleccionada: <strong id="customAbilityOtherName"></strong></span>
                    </div>
                    <input type="hidden" id="customAbilityOther" value="">
                </div>

                <div class="form-group">
                    <label>Ataques (m√°ximo 4, separados por coma):</label>
                    <textarea id="customMoves" placeholder="Ej: Golpe, Rayo, Lanzallamas, Terremoto" rows="3"></textarea>
                </div>
            </div>

            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeCreatePokemonModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="savePokemonToTeam()">Agregar al Equipo</button>
            </div>
        </div>
    </div>

    <!-- Modal para seleccionar Pok√©mon (Comparar o Da√±o) -->
    <div id="selectorModal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <button class="modal-close" onclick="closeSelectorModal()">&times;</button>
            <h2 id="selectorTitle">Seleccionar Pok√©mon</h2>
            <div class="selector-tabs">
                <button class="selector-tab active" data-source="base" onclick="switchSelectorSource('base', event)">Pok√©mon Base</button>
                <button class="selector-tab" data-source="team" onclick="switchSelectorSource('team', event)">Mi Equipo</button>
            </div>
            <input type="text" id="selectorSearch" placeholder="Buscar..." autocomplete="off">
            <div id="selectorList" class="selector-list"></div>
        </div>
    </div>
    <!-- Modal para detalles grandes del Pok√©mon del equipo -->
    <div id="teamPokemonDetailModal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content large-modal">
            <button class="modal-close" onclick="closeTeamPokemonDetail()">&times;</button>
            <div id="teamPokemonDetailBody"></div>
        </div>
    </div>
    <!-- Modal para seleccionar Habilidad -->
    <div id="abilitySelectorModal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <button class="modal-close" onclick="closeAbilitySelector()">&times;</button>
            <h2 id="abilitySelectorTitle">Otras Habilidades</h2>
            <input type="text" id="abilitySelectorSearch" placeholder="Buscar habilidad..." autocomplete="off" style="margin-bottom:10px;">
            <div id="abilitySelectorList" class="selector-list"></div>
            <div id="abilitySelectorDetail" class="detail-box" style="display:none;"></div>
        </div>
    </div>